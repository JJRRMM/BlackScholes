<!DOCTYPE html>
<html lang="en">
<head>
  <title>Black Scholes</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" >
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
  <script src="https://code.jquery.com/jquery.js"></script>
  <!-- <link rel="icon" href="img/mdb-favicon.ico" type="image/x-icon">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
  <!-- Bootstrap core CSS THis CSS file changes the font to small on the form--> 
  <!-- <link rel="stylesheet" href="css/bootstrap.min.css"> -->
   <!-- Material Design Bootstrap -->
   <link rel="stylesheet" href="css/mdb.min.css">
   <!-- Your custom styles (optional) -->
   <link rel="stylesheet" href="css/style.css"> -->
</head>
<body>

<div class="container">
  <!-- <h2>Dynamic Tabs</h2>
  <p>To make the tabs toggleable, add the data-toggle="tab" attribute to each link. Then add a .tab-pane class with a unique ID for every tab and wrap them inside a div element with class .tab-content.</p> -->

  <ul class="nav nav-pills">
    <li class="active"><a data-toggle="tab" href="#home">Currency</a></li>
    <li><a data-toggle="tab" href="#menu1">Equity</a></li>
    <li><a data-toggle="tab" href="#menu2">Index</a></li>
    <li><a data-toggle="tab" href="#menu3">Futures</a></li>
  </ul>

  <div class="tab-content">
    <div id="home" class="tab-pane fade in active">
      <!-- <h3>HOME</h3> -->
      <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
    </div>
    <div id="menu1" class="tab-pane fade">
      <!-- <h3>Call</h3> -->

      <div class="container">
      <div class="row">  
          <div class="col-md-7">  
        <h2>Black Scholes Calculation</h2>
        <form class="form-horizontal">
            <div class="form-group">
                <label class="control-label col-sm-2" for="spot">Spot Price:</label>
                <div class="col-sm-4">
                    <input type="number" class="form-control" id="S" placeholder="Enter Spot Price" name="spot">
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-2" for="strike">Strike Price:</label>
                <div class="col-sm-4">
                    <input type="number" class="form-control" id="K" placeholder="Enter Strike Price" name="strike">
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-2" for="rate">Risk Free Rate:</label>
                <div class="col-sm-4">
                    <input type="number" step="0.01" class="form-control" id="R" placeholder="Enter Risk Free Rate" name="rate">
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-2" for="Volatility">Volatility:</label>
                <div class="col-sm-4">
                    <input type="number" step="0.01" class="form-control" id="V" placeholder="Enter Volatility (% per year):"
                        name="sigma">
                </div>
            </div>
            <div class="form-group">
                    <label class="control-label col-sm-2" for="Time">Time to Maturity:</label>
                    <div class="col-sm-4">
                        <input type="number" class="form-control" id="T" placeholder="Enter Time to Maturity"
                            name="time">
                    </div>
                </div>
            <div class="form-group">
                    <label class="control-label col-sm-2" for="Price">Calulated Price:</label>
                    <div class="col-sm-4">
                        <input type="number" class="form-control" readonly class="form-control-plaintext" id="P" placeholder="Calulated Price"
                            name="price">
                    </div>
             </div>  
             <div class="form-group">
                <label class="control-label col-sm-2" for="Delta">Delta:</label>
                <div class="col-sm-4">
                    <input type="number" class="form-control" readonly class="form-control-plaintext" id="D" placeholder="Delta"
                        name="delta">
                </div>
            </div>  
            <div class="form-group">
                <label class="control-label col-sm-2" for="Gamma">Gamma:</label>
                <div class="col-sm-4">
                    <input type="number" class="form-control" readonly class="form-control-plaintext" id="G" placeholder="Gamma"
                        name="gamma">
                </div>
            </div> 
            <div class="form-group">
                <label class="control-label col-sm-2" for="Vega">Vega:</label>
                <div class="col-sm-4">
                    <input type="number" class="form-control" readonly class="form-control-plaintext" id="Ve" placeholder="Vega"
                        name="vega">
                </div>
            </div> 
            <div class="form-group">
                <label class="control-label col-sm-2" for="Theta">Theta:</label>
                <div class="col-sm-4">
                    <input type="number" class="form-control" readonly class="form-control-plaintext" id="Th" placeholder="Theta"
                        name="theta">
                </div>
            </div> 
            <div class="form-group">
                <label class="control-label col-sm-2" for="Rho">Rho:</label>
                <div class="col-sm-4">
                    <input type="number" class="form-control" readonly class="form-control-plaintext" id="Rh" placeholder="Rho"
                        name="rho">
                </div>
            </div> 
             <div class="form-group">
                <label class="mr-3">
                    <input type="radio" class="mr-1" name="callorput"> Call
                </label>
                <label class="mr-3">
                    <input type="radio" class="mr-1" name="callorput"> Put
                </label>
            </div>
                  
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <button type="calc" class="btn btn-primary calc">Calculate</button>
                </div>
            </div>
            <div class="Panel-body" id="calcSection">
            </div>

        </form>
        
        </div>
        <div class="col-md-5">  
            <!-- <style="background-color: #d4d4eb;box-shadow: inset 1px -1px 1px rgb(224, 213, 213), inset -1px 1px 1px #444;"> -->
               <canvas id="myChart" style="max-width: 500px;"></canvas>
                          
           </div>
        <!-- <div class="col-md-5">
                <p> THe line chart goes here </p>
            </div> -->
     </div>   
    </div>
      
    </div>

    <div id="menu2" class="tab-pane fade">
      <!-- <h3>Put</h3> -->
      <div class="container">
        <h2>Black Scholes Calculation</h2>
        <form class="form-horizontal">
            <div class="form-group">
                <label class="control-label col-sm-2" for="spot">Spot Price:</label>
                <div class="col-sm-4">
                    <input type="number" class="form-control" id="S" placeholder="Enter Spot Price" name="spot">
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-2" for="strike">Strike Price:</label>
                <div class="col-sm-4">
                    <input type="number" class="form-control" id="K" placeholder="Enter Strike Price" name="strike">
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-2" for="rate">Risk Free Rate:</label>
                <div class="col-sm-4">
                    <input type="number" step="0.01" class="form-control" id="R" placeholder="Enter Risk Free Rate" name="rate">
                </div>
            </div>
            <div class="form-group">
                <label class="control-label col-sm-2" for="Volatility">Volatility:</label>
                <div class="col-sm-4">
                    <input type="number" step="0.01" class="form-control" id="V" placeholder="Enter Volatility (% per year):"
                        name="sigma">
                </div>
            </div>
            <div class="form-group">
                    <label class="control-label col-sm-2" for="Time">Time to Maturity:</label>
                    <div class="col-sm-4">
                        <input type="number" class="form-control" id="T" placeholder="Enter Time to Maturity"
                            name="time">
                    </div>
                </div>
            <div class="form-group">
                    <label class="control-label col-sm-2" for="Price">Calulated Price:</label>
                    <div class="col-sm-4">
                        <input type="number" class="form-control" readonly class="form-control-plaintext" id="P" placeholder="Calulated Price"
                            name="price">
                    </div>
             </div>  
            
            <div class="form-group">
                <label class="mr-3">
                    <input type="radio" value="Call" class="mr-1" name="callorput"> Call
                </label>
                <label class="mr-3">
                    <input type="radio" value="Put" class="mr-1" name="callorput"> Put
                </label>
            </div>
                    
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <button type="calc" class="btn btn-primary calc">Calculate</button>
                </div>
            </div>
            <div class="Panel-body" id="calcSection">
            </div>

        </form>
    </div>
      

    </div>
    <div id="menu3" class="tab-pane fade">
      <h3>Menu 3</h3>
      <p>Eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.</p>
    </div>
  </div>
</div>

</body>
</html>
!-- <script type="text/javascript" src="js/jquery.min.js"></script> --> -->
<!-- Bootstrap tooltips -->
<script type="text/javascript" src="js/popper.min.js"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<!-- MDB core JavaScript -->
<script type="text/javascript" src="js/mdb.min.js"></script>
<!-- Your custom scripts (optional) -->


<script type="text/javascript">
    // In this code below we calculate the black scholes price          
    const url = "localhost:3000/"
    $(".calc").on("click", function(event) {
      event.preventDefault();      
      // Here we grab the form elements
       var newCalculation = {
        sprice: $("#S").val().trim(),
        kprice: $("#K").val().trim(),
        rate: $("#R").val().trim(),
        sigma: $("#V").val().trim(),
        time: $("#T").val().trim()
      };       
       var S = 50;
       var K = 50;
       var R = .10
       var V = .30
       var T = .50
       console.log("newCalculation sprice is " ,newCalculation.sprice);
     // Change the func based on radio button selection - 
     // var Calcparams = '?func=BCALL&S=' & S & '&K=' & K & "&R=" & R & "&V=" & V & "&T=" & T ; 
     var func = "BSCALL";
     var Calcparams = "/api/black?func=" + func + "&S=" + S + "&K=" + K + "&r=" + R + "&sigma=" + V + "&time=" + T ;
      console.log("Calcparams = ", Calcparams); 
      // Execute the get below: 
      var Calctest = "/api/black?func=BSPUT&S=50&K=50&r=.10&sigma=.30&time=.50"
      console.log("Calctest is " , Calctest);
      // localhost:8080/api/black?func=BSCALL&S=50&K=50&r=.10&sigma=.30&time=.50                  
      // $.get(Calctest, function( data) {
      //   console.log(data);
      // Grab the url that the server is running on. 
        var currentURL = window.location.origin;
        // console.log("Just before ajax call", currentURL);
        $.ajax({ url: currentURL + Calcparams, method: "GET" })
        .then(function(BlackData) {
        console.log("in the ajax call ", BlackData)         
      // Add a div with the price data wrapped by html. 
        $("#P").val(BlackData["Price"]);
        var calcSection = $("<div>");
        calcSection.addClass("price");
        calcSection.attr("id", "prices-","col-sm-4");
        $("#calcSection").append(calcSection);
        $("#prices-").append("<h2><spann class='label label-primary'>" + "Price:   " + BlackData["Price"]);            
      }); 
      // Change the func based on radio button selection. 
      var func="BSPARTIALCALL"
      var Calcparams = "/api/black?func=" + func + "&S=" + S + "&K=" + K + "&r=" + R + "&sigma=" + V + "&time=" + T ;
      $.ajax({ url: currentURL + Calcparams, method: "GET" })
        .then(function(BlackData) {
        console.log("in the ajax call ", BlackData)         
      // Read the variables in the JSON object and set the values on the form.  
        $("#D").val(BlackData["Delta"]);
        $("#G").val(BlackData["Gamma"]);            
        $("#Ve").val(BlackData["Vega"]);
        $("#Th").val(BlackData["Theta"]);
        $("#Rh").val(BlackData["Rho"]);
      }); 
                     
    });
    // $.ajax()
    </script>